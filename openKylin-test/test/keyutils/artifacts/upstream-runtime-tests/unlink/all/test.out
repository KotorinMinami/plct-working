++++ BEGINNING TEST
+++ ADD KEYRING
keyctl newring wibble @s
171826370
+++ ADD KEY
keyctl add user lizard gizzard 171826370
991778446
+++ LIST KEYRING WITH ONE
keyctl rlist 171826370
991778446
+++ UNLINK KEY FROM KEYRING
keyctl unlink 991778446 171826370
+++ WAITING FOR KEY TO BE UNLINKED
keyctl unlink 991778446 171826370
keyctl_unlink: Required key not available
+++ CHECK NO UNLINK KEY FROM TREE
keyctl unlink 991778446
0 links removed
+++ LIST KEYRING
keyctl rlist 171826370

+++ ADD MULTI KEY
keyctl add user lizard gizzard 171826370
842044824
+++ ADD TWENTY KEYRINGS WITH LINKS
keyctl newring ring0 171826370
50740229
keyctl rlist 171826370
842044824 50740229
keyctl link 842044824 50740229
keyctl rlist 50740229
842044824
keyctl newring ring1 171826370
39887638
keyctl rlist 171826370
842044824 39887638 50740229
keyctl link 842044824 39887638
keyctl rlist 39887638
842044824
keyctl newring ring2 171826370
1003985433
keyctl rlist 171826370
842044824 1003985433 39887638 50740229
keyctl link 842044824 1003985433
keyctl rlist 1003985433
842044824
keyctl newring ring3 171826370
205343196
keyctl rlist 171826370
842044824 205343196 1003985433 39887638 50740229
keyctl link 842044824 205343196
keyctl rlist 205343196
842044824
keyctl newring ring4 171826370
863667786
keyctl rlist 171826370
842044824 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 863667786
keyctl rlist 863667786
842044824
keyctl newring ring5 171826370
383657062
keyctl rlist 171826370
842044824 383657062 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 383657062
keyctl rlist 383657062
842044824
keyctl newring ring6 171826370
909305420
keyctl rlist 171826370
842044824 909305420 383657062 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 909305420
keyctl rlist 909305420
842044824
keyctl newring ring7 171826370
457657148
keyctl rlist 171826370
842044824 457657148 909305420 383657062 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 457657148
keyctl rlist 457657148
842044824
keyctl newring ring8 171826370
908469711
keyctl rlist 171826370
842044824 908469711 457657148 909305420 383657062 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 908469711
keyctl rlist 908469711
842044824
keyctl newring ring9 171826370
775940357
keyctl rlist 171826370
842044824 775940357 908469711 457657148 909305420 383657062 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 775940357
keyctl rlist 775940357
842044824
keyctl newring ring10 171826370
972765709
keyctl rlist 171826370
842044824 972765709 775940357 908469711 457657148 909305420 383657062 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 972765709
keyctl rlist 972765709
842044824
keyctl newring ring11 171826370
391740251
keyctl rlist 171826370
842044824 391740251 972765709 775940357 908469711 457657148 909305420 383657062 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 391740251
keyctl rlist 391740251
842044824
keyctl newring ring12 171826370
54925136
keyctl rlist 171826370
842044824 54925136 391740251 972765709 775940357 908469711 457657148 909305420 383657062 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 54925136
keyctl rlist 54925136
842044824
keyctl newring ring13 171826370
87895008
keyctl rlist 171826370
842044824 87895008 54925136 391740251 972765709 775940357 908469711 457657148 909305420 383657062 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 87895008
keyctl rlist 87895008
842044824
keyctl newring ring14 171826370
28792146
keyctl rlist 171826370
842044824 28792146 87895008 54925136 391740251 972765709 775940357 908469711 457657148 909305420 383657062 863667786 205343196 1003985433 39887638 50740229
keyctl link 842044824 28792146
keyctl rlist 28792146
842044824
keyctl newring ring15 171826370
793589257
keyctl rlist 171826370
842044824 28792146 87895008 54925136 391740251 972765709 775940357 908469711 457657148 909305420 383657062 863667786 205343196 1003985433 39887638 50740229 793589257
keyctl link 842044824 793589257
keyctl rlist 793589257
842044824
keyctl newring ring16 171826370
279556311
keyctl rlist 171826370
842044824 87895008 54925136 391740251 972765709 775940357 908469711 457657148 909305420 383657062 863667786 205343196 1003985433 39887638 793589257 279556311 28792146 50740229
keyctl link 842044824 279556311
keyctl rlist 279556311
842044824
keyctl newring ring17 171826370
925880833
keyctl rlist 171826370
842044824 54925136 391740251 972765709 775940357 908469711 909305420 383657062 863667786 205343196 1003985433 39887638 793589257 279556311 925880833 87895008 457657148 28792146 50740229
keyctl link 842044824 925880833
keyctl rlist 925880833
842044824
keyctl newring ring18 171826370
839001677
keyctl rlist 171826370
842044824 54925136 972765709 775940357 908469711 909305420 383657062 205343196 1003985433 39887638 793589257 279556311 925880833 839001677 391740251 863667786 87895008 457657148 28792146 50740229
keyctl link 842044824 839001677
keyctl rlist 839001677
842044824
keyctl newring ring19 171826370
687470858
keyctl rlist 171826370
842044824 54925136 972765709 775940357 908469711 909305420 383657062 205343196 1003985433 39887638 793589257 279556311 925880833 839001677 391740251 863667786 687470858 87895008 457657148 28792146 50740229
keyctl link 842044824 687470858
keyctl rlist 687470858
842044824
+++ SHOW
Session Keyring
  87390825 --alswrv   1000  1000  keyring: RHTS/keyctl/5838
 171826370 --alswrv   1000  1000   \_ keyring: wibble
 842044824 --alswrv   1000  1000       \_ user: lizard
  54925136 --alswrv   1000  1000       \_ keyring: ring12
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 972765709 --alswrv   1000  1000       \_ keyring: ring10
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 775940357 --alswrv   1000  1000       \_ keyring: ring9
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 908469711 --alswrv   1000  1000       \_ keyring: ring8
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 909305420 --alswrv   1000  1000       \_ keyring: ring6
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 383657062 --alswrv   1000  1000       \_ keyring: ring5
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 205343196 --alswrv   1000  1000       \_ keyring: ring3
 842044824 --alswrv   1000  1000       |   \_ user: lizard
1003985433 --alswrv   1000  1000       \_ keyring: ring2
 842044824 --alswrv   1000  1000       |   \_ user: lizard
  39887638 --alswrv   1000  1000       \_ keyring: ring1
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 793589257 --alswrv   1000  1000       \_ keyring: ring15
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 279556311 --alswrv   1000  1000       \_ keyring: ring16
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 925880833 --alswrv   1000  1000       \_ keyring: ring17
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 839001677 --alswrv   1000  1000       \_ keyring: ring18
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 391740251 --alswrv   1000  1000       \_ keyring: ring11
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 863667786 --alswrv   1000  1000       \_ keyring: ring4
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 687470858 --alswrv   1000  1000       \_ keyring: ring19
 842044824 --alswrv   1000  1000       |   \_ user: lizard
  87895008 --alswrv   1000  1000       \_ keyring: ring13
 842044824 --alswrv   1000  1000       |   \_ user: lizard
 457657148 --alswrv   1000  1000       \_ keyring: ring7
 842044824 --alswrv   1000  1000       |   \_ user: lizard
  28792146 --alswrv   1000  1000       \_ keyring: ring14
 842044824 --alswrv   1000  1000       |   \_ user: lizard
  50740229 --alswrv   1000  1000       \_ keyring: ring0
 842044824 --alswrv   1000  1000           \_ user: lizard
+++ REMOVE ALL LINKS TO KEY
keyctl unlink 842044824
21 links removed
keyctl unlink 842044824
0 links removed
+++ CHECK GONE
keyctl rlist 171826370
54925136 972765709 775940357 908469711 909305420 383657062 205343196 1003985433 39887638 793589257 279556311 925880833 839001677 391740251 863667786 687470858 87895008 457657148 28792146 50740229
keyctl rlist 50740229

keyctl rlist 39887638

keyctl rlist 1003985433

keyctl rlist 205343196

keyctl rlist 863667786

keyctl rlist 383657062

keyctl rlist 909305420

keyctl rlist 457657148

keyctl rlist 908469711

keyctl rlist 775940357

keyctl rlist 972765709

keyctl rlist 391740251

keyctl rlist 54925136

keyctl rlist 87895008

keyctl rlist 28792146

keyctl rlist 793589257

keyctl rlist 279556311

keyctl rlist 925880833

keyctl rlist 839001677

keyctl rlist 687470858

+++ UNLINK KEY
keyctl unlink 171826370 @s
++++ FINISHED TEST: PASS
