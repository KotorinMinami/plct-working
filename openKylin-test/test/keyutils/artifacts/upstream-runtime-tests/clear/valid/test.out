++++ BEGINNING TEST
+++ ADD KEYRING
keyctl newring wibble @s
14011742
+++ VALIDATE KEYRING
keyctl rdescribe 14011742 @
keyring@1000@1000@3f010000@wibble
+++ LIST KEYRING
keyctl rlist 14011742

+++ CLEAR EMPTY KEYRING
keyctl clear 14011742
+++ LIST KEYRING 2
keyctl rlist 14011742

+++ ADD KEY
keyctl add user lizard gizzard 14011742
814131299
+++ LIST KEYRING WITH ONE
keyctl rlist 14011742
814131299
+++ CLEAR KEYRING WITH ONE
keyctl clear 14011742
+++ LIST KEYRING 3
keyctl rlist 14011742

+++ ADD FORTY KEYS
keyctl add user lizard0 gizzard0 14011742
17866553
keyctl rlist 14011742
17866553
keyctl add user lizard1 gizzard1 14011742
944427337
keyctl rlist 14011742
17866553 944427337
keyctl add user lizard2 gizzard2 14011742
142290536
keyctl rlist 14011742
17866553 142290536 944427337
keyctl add user lizard3 gizzard3 14011742
1001357142
keyctl rlist 14011742
17866553 1001357142 142290536 944427337
keyctl add user lizard4 gizzard4 14011742
430206868
keyctl rlist 14011742
17866553 430206868 1001357142 142290536 944427337
keyctl add user lizard5 gizzard5 14011742
395682391
keyctl rlist 14011742
17866553 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard6 gizzard6 14011742
710773486
keyctl rlist 14011742
17866553 710773486 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard7 gizzard7 14011742
688529500
keyctl rlist 14011742
17866553 688529500 710773486 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard8 gizzard8 14011742
729219706
keyctl rlist 14011742
17866553 729219706 688529500 710773486 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard9 gizzard9 14011742
611231089
keyctl rlist 14011742
17866553 611231089 729219706 688529500 710773486 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard10 gizzard10 14011742
266670340
keyctl rlist 14011742
17866553 266670340 611231089 729219706 688529500 710773486 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard11 gizzard11 14011742
927895819
keyctl rlist 14011742
17866553 927895819 266670340 611231089 729219706 688529500 710773486 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard12 gizzard12 14011742
68594584
keyctl rlist 14011742
17866553 68594584 927895819 266670340 611231089 729219706 688529500 710773486 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard13 gizzard13 14011742
825954907
keyctl rlist 14011742
17866553 825954907 68594584 927895819 266670340 611231089 729219706 688529500 710773486 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard14 gizzard14 14011742
699293766
keyctl rlist 14011742
17866553 699293766 825954907 68594584 927895819 266670340 611231089 729219706 688529500 710773486 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard15 gizzard15 14011742
1068666096
keyctl rlist 14011742
17866553 1068666096 699293766 825954907 68594584 927895819 266670340 611231089 729219706 688529500 710773486 395682391 430206868 1001357142 142290536 944427337
keyctl add user lizard16 gizzard16 14011742
736108764
keyctl rlist 14011742
699293766 825954907 68594584 927895819 266670340 611231089 729219706 688529500 710773486 395682391 430206868 1001357142 142290536 944427337 736108764 17866553 1068666096
keyctl add user lizard17 gizzard17 14011742
779676990
keyctl rlist 14011742
825954907 927895819 266670340 611231089 729219706 688529500 710773486 395682391 430206868 1001357142 142290536 944427337 736108764 779676990 699293766 68594584 17866553 1068666096
keyctl add user lizard18 gizzard18 14011742
102091034
keyctl rlist 14011742
927895819 266670340 611231089 729219706 710773486 395682391 430206868 1001357142 142290536 944427337 736108764 779676990 102091034 825954907 688529500 699293766 68594584 17866553 1068666096
keyctl add user lizard19 gizzard19 14011742
169358711
keyctl rlist 14011742
927895819 266670340 729219706 710773486 395682391 430206868 1001357142 142290536 944427337 736108764 102091034 169358711 825954907 688529500 699293766 68594584 17866553 1068666096 611231089 779676990
keyctl add user lizard20 gizzard20 14011742
251489513
keyctl rlist 14011742
266670340 729219706 710773486 395682391 430206868 1001357142 142290536 944427337 736108764 102091034 169358711 825954907 688529500 699293766 68594584 17866553 1068666096 611231089 779676990 927895819 251489513
keyctl add user lizard21 gizzard21 14011742
1051416812
keyctl rlist 14011742
266670340 729219706 710773486 395682391 430206868 142290536 944427337 102091034 169358711 1051416812 825954907 688529500 699293766 68594584 17866553 1068666096 1001357142 736108764 611231089 779676990 927895819 251489513
keyctl add user lizard22 gizzard22 14011742
611785255
keyctl rlist 14011742
266670340 729219706 710773486 395682391 430206868 142290536 944427337 102091034 169358711 1051416812 825954907 688529500 611785255 699293766 68594584 17866553 1068666096 1001357142 736108764 611231089 779676990 927895819 251489513
keyctl add user lizard23 gizzard23 14011742
906579301
keyctl rlist 14011742
266670340 729219706 710773486 395682391 430206868 944427337 102091034 1051416812 906579301 825954907 688529500 611785255 699293766 68594584 17866553 1068666096 1001357142 736108764 611231089 779676990 142290536 169358711 927895819 251489513
keyctl add user lizard24 gizzard24 14011742
875330657
keyctl rlist 14011742
266670340 729219706 710773486 395682391 430206868 944427337 102091034 1051416812 906579301 825954907 688529500 611785255 699293766 68594584 17866553 1068666096 875330657 1001357142 736108764 611231089 779676990 142290536 169358711 927895819 251489513
keyctl add user lizard25 gizzard25 14011742
113761279
keyctl rlist 14011742
266670340 729219706 710773486 395682391 430206868 944427337 102091034 1051416812 906579301 825954907 688529500 611785255 699293766 68594584 17866553 1068666096 875330657 1001357142 736108764 113761279 611231089 779676990 142290536 169358711 927895819 251489513
keyctl add user lizard26 gizzard26 14011742
1041412684
keyctl rlist 14011742
266670340 729219706 710773486 395682391 430206868 944427337 102091034 1051416812 906579301 825954907 688529500 611785255 699293766 68594584 17866553 1068666096 875330657 1001357142 736108764 113761279 611231089 779676990 1041412684 142290536 169358711 927895819 251489513
keyctl add user lizard27 gizzard27 14011742
410340520
keyctl rlist 14011742
266670340 729219706 710773486 395682391 430206868 102091034 906579301 410340520 825954907 688529500 611785255 699293766 68594584 17866553 1068666096 875330657 1001357142 736108764 113761279 611231089 779676990 1041412684 142290536 169358711 927895819 251489513 944427337 1051416812
keyctl add user lizard28 gizzard28 14011742
498047053
keyctl rlist 14011742
266670340 729219706 710773486 395682391 102091034 906579301 410340520 825954907 688529500 611785255 699293766 68594584 17866553 1068666096 875330657 1001357142 736108764 113761279 611231089 779676990 1041412684 430206868 498047053 142290536 169358711 927895819 251489513 944427337 1051416812
keyctl add user lizard29 gizzard29 14011742
622734139
keyctl rlist 14011742
266670340 729219706 710773486 102091034 906579301 410340520 825954907 688529500 611785255 699293766 68594584 17866553 1068666096 875330657 1001357142 736108764 113761279 611231089 779676990 1041412684 430206868 498047053 142290536 169358711 395682391 622734139 927895819 251489513 944427337 1051416812
keyctl add user lizard30 gizzard30 14011742
903451159
keyctl rlist 14011742
266670340 729219706 710773486 102091034 906579301 410340520 825954907 688529500 611785255 699293766 68594584 17866553 1068666096 875330657 1001357142 736108764 113761279 611231089 779676990 1041412684 430206868 498047053 142290536 169358711 395682391 622734139 927895819 251489513 944427337 1051416812 903451159
keyctl add user lizard31 gizzard31 14011742
1018320950
keyctl rlist 14011742
266670340 729219706 710773486 102091034 906579301 410340520 825954907 688529500 1018320950 611785255 699293766 68594584 17866553 1068666096 875330657 1001357142 736108764 113761279 611231089 779676990 1041412684 430206868 498047053 142290536 169358711 395682391 622734139 927895819 251489513 944427337 1051416812 903451159
keyctl add user lizard32 gizzard32 14011742
839946517
keyctl rlist 14011742
266670340 729219706 710773486 906579301 839946517 825954907 688529500 1018320950 611785255 699293766 68594584 17866553 1068666096 875330657 1001357142 736108764 113761279 611231089 779676990 1041412684 102091034 410340520 430206868 498047053 142290536 169358711 395682391 622734139 927895819 251489513 944427337 1051416812 903451159
keyctl add user lizard33 gizzard33 14011742
662477748
keyctl rlist 14011742
266670340 729219706 710773486 906579301 839946517 825954907 688529500 1018320950 611785255 699293766 68594584 662477748 17866553 1068666096 875330657 1001357142 736108764 113761279 611231089 779676990 1041412684 102091034 410340520 430206868 498047053 142290536 169358711 395682391 622734139 927895819 251489513 944427337 1051416812 903451159
keyctl add user lizard34 gizzard34 14011742
147547937
keyctl rlist 14011742
266670340 729219706 710773486 906579301 839946517 825954907 688529500 1018320950 611785255 699293766 68594584 662477748 17866553 1068666096 875330657 1001357142 736108764 147547937 113761279 611231089 779676990 1041412684 102091034 410340520 430206868 498047053 142290536 169358711 395682391 622734139 927895819 251489513 944427337 1051416812 903451159
keyctl add user lizard35 gizzard35 14011742
1056838457
keyctl rlist 14011742
266670340 729219706 906579301 839946517 825954907 688529500 1018320950 611785255 699293766 68594584 662477748 17866553 1068666096 875330657 1001357142 736108764 147547937 113761279 710773486 1056838457 611231089 779676990 1041412684 102091034 410340520 430206868 498047053 142290536 169358711 395682391 622734139 927895819 251489513 944427337 1051416812 903451159
keyctl add user lizard36 gizzard36 14011742
858809235
keyctl rlist 14011742
266670340 729219706 906579301 839946517 825954907 688529500 1018320950 611785255 699293766 68594584 662477748 17866553 1068666096 875330657 1001357142 736108764 147547937 113761279 710773486 1056838457 611231089 779676990 1041412684 102091034 410340520 858809235 430206868 498047053 142290536 169358711 395682391 622734139 927895819 251489513 944427337 1051416812 903451159
keyctl add user lizard37 gizzard37 14011742
381776663
keyctl rlist 14011742
266670340 729219706 906579301 839946517 825954907 688529500 1018320950 611785255 699293766 68594584 662477748 17866553 1068666096 875330657 1001357142 736108764 147547937 113761279 710773486 1056838457 611231089 779676990 1041412684 102091034 410340520 858809235 430206868 498047053 381776663 142290536 169358711 395682391 622734139 927895819 251489513 944427337 1051416812 903451159
keyctl add user lizard38 gizzard38 14011742
189997274
keyctl rlist 14011742
266670340 729219706 906579301 839946517 825954907 688529500 1018320950 611785255 699293766 68594584 662477748 17866553 1068666096 875330657 1001357142 736108764 147547937 113761279 710773486 1056838457 611231089 779676990 1041412684 102091034 410340520 858809235 430206868 498047053 381776663 142290536 169358711 395682391 622734139 189997274 927895819 251489513 944427337 1051416812 903451159
keyctl add user lizard39 gizzard39 14011742
908818205
keyctl rlist 14011742
266670340 906579301 839946517 825954907 688529500 1018320950 611785255 699293766 68594584 662477748 17866553 1068666096 875330657 1001357142 736108764 147547937 113761279 710773486 1056838457 611231089 779676990 1041412684 102091034 410340520 858809235 430206868 498047053 381776663 142290536 169358711 395682391 622734139 189997274 729219706 908818205 927895819 251489513 944427337 1051416812 903451159
+++ CHECK KEYRING CONTENTS
keyctl rlist 14011742
266670340 906579301 839946517 825954907 688529500 1018320950 611785255 699293766 68594584 662477748 17866553 1068666096 875330657 1001357142 736108764 147547937 113761279 710773486 1056838457 611231089 779676990 1041412684 102091034 410340520 858809235 430206868 498047053 381776663 142290536 169358711 395682391 622734139 189997274 729219706 908818205 927895819 251489513 944427337 1051416812 903451159
+++ SHOW KEYRING
Session Keyring
 700056163 --alswrv   1000  1000  keyring: RHTS/keyctl/4096
  14011742 --alswrv   1000  1000   \_ keyring: wibble
 266670340 --alswrv   1000  1000       \_ user: lizard10
 906579301 --alswrv   1000  1000       \_ user: lizard23
 839946517 --alswrv   1000  1000       \_ user: lizard32
 825954907 --alswrv   1000  1000       \_ user: lizard13
 688529500 --alswrv   1000  1000       \_ user: lizard7
1018320950 --alswrv   1000  1000       \_ user: lizard31
 611785255 --alswrv   1000  1000       \_ user: lizard22
 699293766 --alswrv   1000  1000       \_ user: lizard14
  68594584 --alswrv   1000  1000       \_ user: lizard12
 662477748 --alswrv   1000  1000       \_ user: lizard33
  17866553 --alswrv   1000  1000       \_ user: lizard0
1068666096 --alswrv   1000  1000       \_ user: lizard15
 875330657 --alswrv   1000  1000       \_ user: lizard24
1001357142 --alswrv   1000  1000       \_ user: lizard3
 736108764 --alswrv   1000  1000       \_ user: lizard16
 147547937 --alswrv   1000  1000       \_ user: lizard34
 113761279 --alswrv   1000  1000       \_ user: lizard25
 710773486 --alswrv   1000  1000       \_ user: lizard6
1056838457 --alswrv   1000  1000       \_ user: lizard35
 611231089 --alswrv   1000  1000       \_ user: lizard9
 779676990 --alswrv   1000  1000       \_ user: lizard17
1041412684 --alswrv   1000  1000       \_ user: lizard26
 102091034 --alswrv   1000  1000       \_ user: lizard18
 410340520 --alswrv   1000  1000       \_ user: lizard27
 858809235 --alswrv   1000  1000       \_ user: lizard36
 430206868 --alswrv   1000  1000       \_ user: lizard4
 498047053 --alswrv   1000  1000       \_ user: lizard28
 381776663 --alswrv   1000  1000       \_ user: lizard37
 142290536 --alswrv   1000  1000       \_ user: lizard2
 169358711 --alswrv   1000  1000       \_ user: lizard19
 395682391 --alswrv   1000  1000       \_ user: lizard5
 622734139 --alswrv   1000  1000       \_ user: lizard29
 189997274 --alswrv   1000  1000       \_ user: lizard38
 729219706 --alswrv   1000  1000       \_ user: lizard8
 908818205 --alswrv   1000  1000       \_ user: lizard39
 927895819 --alswrv   1000  1000       \_ user: lizard11
 251489513 --alswrv   1000  1000       \_ user: lizard20
 944427337 --alswrv   1000  1000       \_ user: lizard1
1051416812 --alswrv   1000  1000       \_ user: lizard21
 903451159 --alswrv   1000  1000       \_ user: lizard30
+++ CLEAR KEYRING WITH ONE
keyctl clear 14011742
+++ LIST KEYRING 4
keyctl rlist 14011742

+++ UNLINK KEY
keyctl unlink 14011742 @s
++++ FINISHED TEST: PASS
