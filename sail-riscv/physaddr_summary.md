Sail-RISCV, serving as a golden model for the RISC-V ISA, exhibits two primary limitations within its memory model: the absence of 34-bit physical address support in RV32, and the ambiguity between physical and virtual memory. To address these deficiencies, we have reconstructed the Sail-RISCV memory model. Specifically, we employed newtype constructs to distinguish physical and virtual memory, and enabled 34-bit physical address support by allowing arbitrary-width address mappings to Sail-supported address types. We refined the communication mechanism with Sail's simulated memory to accommodate arbitrary-width physical addresses, which are then mapped to corresponding Sail memory model addresses. Through experimentation, involving varying address widths, we validated the efficacy of this approach, demonstrating its correct handling of 34-bit addresses. Results indicated enhanced type-safety and improved model accuracy.

Compared to alternative methods, our implementation offers greater flexibility, reducing the coupling risk between physical and virtual memory and providing a more precise memory abstraction for the Sail-RISCV model. For example, utilizing newtype constructs ensures compile-time memory type safety. Experimental results confirmed our success in resolving type-safety concerns and extending Sail-RISCVâ€™s support for 34-bit physical addresses. This enhancement, we believe, bolsters the accuracy of Sail-RISCV as a golden model for RISC-V. Future efforts will focus on further enhancing the performance and reliability of Sail-RISCV.
